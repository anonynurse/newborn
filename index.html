<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Newborn</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:0; padding:16px; }
    #page { margin:auto; width:100%; max-width:900px; }
    .row { display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .col { display:flex; align-items:center; gap:8px; }
    button { padding:10px 14px; border:1px solid #ccc; border-radius:8px; background:#f6f6f6; cursor:pointer; }
    button:hover { background:#eee; }
    textarea { width:100%; height:60vh; font-size:8pt; }
    input[type="text"] { width:6ch; text-align:center; }
    .small { font-size:12px; color:#666; }
  </style>
</head>
<body>
  <div id="page">
    <div class="row" style="margin-bottom:8px;">
      <div class="col" style="flex:1;">
        <button id="play" style="flex:1;">Play</button>
      </div>
      <div class="col" style="flex:1; justify-content:flex-end;">
        <button id="step" style="flex:1;">Step</button>
      </div>
    </div>

    <div class="row" style="margin-bottom:8px;">
      <div class="col">
        <button id="scorebtn">mistake</button>
        <input id="score" type="text" value="0" read-only>
      </div>
      <div class="col">
        <input type="checkbox" id="soundCheckbox" checked>
        <label for="soundCheckbox">sound</label>
        <span class="small" id="status"></span>
      </div>
    </div>
  </br>
    <div id="txtarea">
      <textarea id="textArea">
Priorities for assessment
   thermoregulation
   baby safety
Review Chart
   time of birth
   bathed
   feeding
   complications
   notes on baby
Gather equipment
   gloves
   stethy
   thermometer
   diaper
Introduction
   enter room hand hygiene
   Introduce self (name and role)
   Ask Patient name
   match bracelet to chart
   2 identifiers (name and number)
   match baby bracelet to patient
   inform parent of interaction
   obtain consent
Vitals
	Temperature
		set to newborn axillary
		in line with body
		tip in the axilla
		state normal range:
			36.5 to 37.5
	Pulse
		landmark apical pulse:
			left side mid clavicular 4th intercostal
		auscultate for 1 minute
		normal range is:
			110 to 160
		murmurs may be present (foramen ovale)
	Respirations
		auscultate for 1 minute
		normal range is:
			30 to 60
		breathing patters are regular or irregular
		episodes of apnea are normal if under 20 seconds
		signs of respiratory distress:
			grunting
			gasping
			intercostal retractions
			nasal flaring
		check patency of nares by observation or gentle occlusion
			do not put anything in nose
	Lung Sounds
		auscultate all fields:
			4 anterior
			2 lateral
			4 posterior
		normal findings:
			typically shallow and irregular, minor crackles
		abnormal findings:
			coarse crackles, stridor, long apnea
Head
	inspect and palpate shape, note:
		shape
		cranial sutures
		molding
		caput
		cephalohematoma
	fontanelles:
		anterior: diamond, under 5cm, closes 12 to 18 months
		posterior: triangle, under 1cm, closes 6 to 8 weeks
	head circumference:
		measure just above eyes and ears at widest point
		normal range:
			33 to 35 cm, 32 to 37 cm is normal variation
Eyes Ears Mouth
	overall appearance and symmetry
	eye sclera color: white or jaundice
	ear alignment with eyes
	PUT ON CLEAN GLOVE
	check rooting reflex
	check mouth symmetry
	palpate soft and hard palate looking for cleft or tongue tied
	SWAP GLOVES
Chest
	palpate both clavicles: intact
	assess nipples for: 
		size, placement, number
Abdomen
	inspect abdomen, shape is:
		rounded
	establish if stool passed (meconium)
	auscultate bowel sounds
	inspect umbilical cord
		should be: clean, dry, white, defined from abdomen, odorless
		keep clean and clear of diaper
Genetalia
	male: 
		inspect penis and meatus (do not retract) palpate testes (descended)
	female:
		labia maj / min usually edema, presence of discharge or pseudomenses
Back and extremities
	inspect and palpate spine (scoliosis)
	check for pilonidal dimple (hair, discharge, less than 5 mm)
	count fingers and toes
	check Babinski: 
		draw finger from heel to ball of foot should flare
	check Grasp:
		finger in hand should grab
Skin
	color (some acrocyanosis normal, no central)
	note vernix and lanugo
	identify normal skin markings:
		slate grey nevi, dark spot on buttocks, lasts months years
		nevi telangiectatic, angel kisses, 
		nevus flammeus, port wine stain, usually permanent
		erythema toxicum, newborn rash,
Patient Teaching
	ask if baby has had wet or soiled diaper
	expected urination
		first void in 24 to 48 hrs
		progression 1 on day 1, 2 on 2, 3 on 3
		by day 3 should be heavy and clear or light yellow
		urination is an indicator for hydration
	expected stools
		meconium, dark black brown sticky, day 1 and 2
		transitional, going from brown to green, day 3 and 4
		milk stool, large yellow seedy filled diapers, day 5 on
		day 1 and 2 have 1 or 2 stools
		day 3 on atleast 3 
	ask how feeding is going
	feeding should be atleast 8 per day:
		may be spread out or clustered
		look for early signs of hunger
			hand to mouth
			hunger posture
			mouthing or sucking
		crying is a late sign
		try to feed on cue, usually have a pattern by 3 or 4 weeks
		weightloss is normal should be less than 10% and regain by 10 to 14 days
Closing
	ease in by asking if there are any other concerns or questions
	inform parents of findings
	HAND HYGIENE
	leave room
      </textarea>
    </div>
  </div>

  <audio id="ttsAudio" preload="auto"></audio>

  <script>
    // Replace with your Worker URL:
    const WORKER_URL = "https://postpartum-tts.chris8331.workers.dev/api/tts"; 
    const VOICE = "en-US-JennyNeural";
    const FORMAT = "audio-24khz-48kbitrate-mono-mp3";

    let lines = [];
    let index = 0;
    let playing = false;

    const playBtn = document.getElementById("play");
    const stepBtn = document.getElementById("step");
    const scoreBtn = document.getElementById("scorebtn");
    const scoreInput = document.getElementById("score");
    const textArea = document.getElementById("textArea");
    const soundCheckbox = document.getElementById("soundCheckbox");
    const audioEl = document.getElementById("ttsAudio");
    const statusEl = document.getElementById("status");

    function setStatus(msg) { statusEl.textContent = msg || ""; }

    async function speak(text) {
      if (!soundCheckbox.checked || !text.trim()) return;

      // Try Cloud TTS
      try {
        setStatus("cloud TTS…");
        const res = await fetch(WORKER_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text, voice: VOICE, format: FORMAT })
        });
        if (!res.ok) throw new Error(await res.text());
        const blob = await res.blob();
        if (blob.size < 2000) throw new Error("Empty audio");
        audioEl.src = URL.createObjectURL(blob);
        await audioEl.play();
        setStatus("");
        return; // success
      } catch (err) {
        console.warn("Cloud TTS failed, falling back:", err);
        setStatus("cloud TTS failed → local voice");
      }

      // Fallback: browser speechSynthesis
      try {
        const utter = new SpeechSynthesisUtterance(text);
        const voices = speechSynthesis.getVoices();
        utter.voice = voices.find(v => v.lang === "en-US") || voices.find(v => v.lang.startsWith("en")) || null;
        utter.rate = 1.0;
        utter.pitch = 1.0;
        speechSynthesis.speak(utter);
      } catch (err) {
        console.error("Local TTS also failed:", err);
        setStatus("all TTS failed");
      }
    }

    playBtn.addEventListener("click", function() {
      if (playing) return;
      playing = true;
      lines = textArea.value.split("\n");
      textArea.value = "";
      index = 0;
      playLines();
    });

    stepBtn.addEventListener("click", function() {
      if (index === 0) {
        lines = textArea.value.split("\n");
        textArea.value = "";
      }
      if (index <= lines.length && index !== 0) {
        const line = lines[index - 1];
        textArea.value += line + "\n";
        textArea.scrollTop = textArea.scrollHeight;
        speak(line);
      }
      index++;
    });

    scoreBtn.addEventListener("click", function() {
      scoreInput.value = parseInt(scoreInput.value, 10) + 1;
      textArea.value += "*** ^ ***\n";
    });

    function playLines() {
      if (index >= lines.length) {
        playing = false;
        return;
      }
      const line = lines[index];
      textArea.value += line + "\n";
      textArea.scrollTop = textArea.scrollHeight;
      speak(line);
      index++;
      setTimeout(playLines, 3000);
    }
  </script>
</body>
</html>
